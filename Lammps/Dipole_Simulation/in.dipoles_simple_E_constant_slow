units   lj
dimension 3
atom_style hybrid sphere dipole
boundary p p p


region box block -20 20 -20 20 -20 20
create_box 1 box

lattice sc 0.0005
region sim block  -5 5 -5 5 -5 5 
create_atoms 1 region sim

mass 1 1.0
set type 1 diameter 1.0

fix E all efield 0 0 .5

variable mu equal 2.5
set group all dipole/random 12345 ${mu}

neighbor 0.3 bin
neigh_modify delay 0 every 1 check yes

pair_style lj/cut/dipole/long 2.5 8
pair_coeff 1 1 1. 1. 2.5 
dielectric 1
kspace_style pppm/dipole 1.0e-5

timestep 0.0001 
fix integrate all nve/sphere update dipole 
compute Tsph all temp/sphere 
fix thermoT all langevin 1.0 1.0 1.0 904297 omega yes
thermo_modify temp Tsph

thermo 500
thermo_style custom step temp vol etotal press pe ke 
compute td all temp/deform
compute md all property/atom mux muy muz
dump d1 all custom 200 dipoles_slow.lammpstrj id type x y z mux muy muz 

run 20000
